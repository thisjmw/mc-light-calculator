(function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],d=0,u=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);h&&h(t);while(u.length)u.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],r=!0,s=1;s<i.length;s++){var c=i[s];0!==n[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=i[0]))}return e}var r={},n={app:0},a=[];function o(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=r,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(i,r,function(t){return e[t]}.bind(null,r));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var h=c;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"034f":function(e,t,i){"use strict";var r=i("85ec"),n=i.n(r);n.a},"3f2f":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var r=i("2b0e"),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("LightGridControlSelector",{on:{"change-control":e.changeControl,"change-view":e.changeView,reset:e.reset}}),i("LightGrid",{attrs:{width:e.gridWidth,height:e.gridHeight,lights:e.lights,walls:e.walls,elevations:e.elevations,control:e.controlType,"grid-view":e.gridView},on:{"add-light":e.addLight,"remove-light":e.removeLight,"add-wall":e.addWall,"remove-wall":e.removeWall,"increase-elevation":e.increaseElevation,reset:e.reset}})],1)},a=[],o=(i("99af"),i("4de4"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"grid-container",style:e.gridLayout,on:{mouseleave:e.mouseLeft}},e._l(e.grid,(function(t,r){return i("div",{key:r,staticClass:"block",class:e.blockStyle(t),on:{mousedown:function(t){return e.mouseDown(r)},mouseenter:function(t){e.dragging&&e.mouseEnter(r)},mouseup:e.mouseUp}},[e.gridView===e.gridViewEnum.LIGHT?[e._v(" "+e._s(t.type!==e.blockTypeEnum.WALL?t.strength:"")+" ")]:e.gridView===e.gridViewEnum.ELEVATION?[e._v(" "+e._s(t.elevation)+" ")]:e._e()],2)})),0)}),s=[],c=(i("0481"),i("c975"),i("4069"),i("a9e3"),i("ade3")),l=i("5530"),h=i("b85c"),d={NORMAL:1,LIGHT:2,WALL:3},u={LIGHT:1,ELEVATION:2},g={NONE:0,ADD_LIGHT:1,REMOVE_LIGHT:2,ADD_WALL:3,REMOVE_WALL:4,INCREASE_ELEVATION:5},p={name:"LightGrid",emits:["add-light","remove-light","add-wall","remove-wall","increase-elevation"],props:{width:{type:Number,validator:function(e){return e>0}},height:{type:Number,validator:function(e){return e>0}},lights:Array,walls:Array,elevations:Object,control:Number,gridView:Number},data:function(){return{processed:0,updated:0,duplicated:0,blockTypeEnum:d,gridViewEnum:u,dragging:!1,dragHistory:[],dragBehavior:g.NONE}},computed:{grid:function(){for(var e=[],t=0;t<this.height;t++){e[t]=[];for(var i=0;i<this.width;i++){var r=this.elevations["".concat(i,",").concat(t)]||0;e[t][i]={strength:0,type:d.NORMAL,elevation:r}}}return this.gridView===u.LIGHT?this.calculateLighting(e):e.flat()},gridLayout:function(){return{gridTemplateColumns:"repeat(".concat(this.width,", 1.2rem)")}}},methods:{getEntityIndexMap:function(e){var t,i={},r=Object(h["a"])(this[e]);try{for(r.s();!(t=r.n()).done;){var n=t.value;i[this.coordinatesToIndex(n.x,n.y)]=n}}catch(a){r.e(a)}finally{r.f()}return i},calculateLighting:function(e){if(this.processed=0,this.updated=0,this.duplicated=0,!this.lights.length&&!this.walls.length)return e.flat();var t,i=[],r=Object(h["a"])(this.walls);try{for(r.s();!(t=r.n()).done;){var n=t.value;i.push(Object(l["a"])(Object(l["a"])({},n),{},{type:d.WALL}))}}catch(m){r.e(m)}finally{r.f()}var a,o=Object(h["a"])(this.lights);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push(Object(l["a"])(Object(l["a"])({},s),{},{type:d.LIGHT}))}}catch(m){o.e(m)}finally{o.f()}var c=i.shift();while(c){this.processed++;var u=c,g=u.x,p=u.y,v=u.type;if(c.elevation=e[p][g].elevation,v===d.WALL)this.updated++,e[p][g]=Object(l["a"])(Object(l["a"])({},e[p][g]),{},{type:v});else if(e[p][g].strength<c.strength){this.updated++;var f=c.strength;e[p][g]=Object(l["a"])(Object(l["a"])({},e[p][g]),{},{type:v,strength:f}),f>1&&(L(e,i,g,p-1,p>0,c),L(e,i,g+1,p,g<this.width-1,c),L(e,i,g,p+1,p<this.height-1,c),L(e,i,g-1,p,g>0,c))}else this.duplicated++;c=i.shift()}return e.flat();function L(e,t,i,r,n,a){if(n&&e[r][i].strength<a.strength-1){var o=e[r][i].elevation,s=Math.abs(o-a.elevation),c=a.strength-1-s;c>0&&c>e[r][i].strength&&t.push({x:i,y:r,elevation:o,strength:c,type:e[r][i].type})}}},clicked:function(e){var t,i=this.indexToCoordinates(e);switch(this.gridView){case u.LIGHT:var r=(t={},Object(c["a"])(t,d.LIGHT,{targetObjectExistsAtCoordinates:this.isBlockType(d.LIGHT,e),replaceableObjectExistsAtCoordinates:this.isBlockType(d.WALL,e),targetObjectName:"light",replaceableObjectName:"wall"}),Object(c["a"])(t,d.WALL,{targetObjectExistsAtCoordinates:this.isBlockType(d.WALL,e),replaceableObjectExistsAtCoordinates:this.isBlockType(d.LIGHT,e),targetObjectName:"wall",replaceableObjectName:"light"}),t),n=r[this.control];n.targetObjectExistsAtCoordinates?this.$emit("remove-".concat(n.targetObjectName),i):(n.replaceableObjectExistsAtCoordinates&&this.$emit("remove-".concat(n.replaceableObjectName),i),this.$emit("add-".concat(n.targetObjectName),i));break;case u.ELEVATION:this.$emit("increase-elevation",i);break}},blockStyle:function(e){var t;switch(this.gridView){case u.LIGHT:var i="light-".concat(e.strength);return t={light:e.type===d.LIGHT},Object(c["a"])(t,i,e.type!==d.WALL),Object(c["a"])(t,"wall",e.type===d.WALL),Object(c["a"])(t,"danger",e.type!==d.WALL&&e.strength<8),t;case u.ELEVATION:var r="elevation-".concat(e.elevation>3?3:e.elevation);return Object(c["a"])({elevation:!0},r,!0)}},indexToCoordinates:function(e){var t=Math.floor(e/this.width),i=e-t*this.width,r=this.grid[e].elevation;return{x:i,y:t,elevation:r}},coordinatesToIndex:function(e,t){return e+t*this.width},isBlockType:function(e,t){var i,r=(i={},Object(c["a"])(i,d.LIGHT,"lights"),Object(c["a"])(i,d.WALL,"walls"),i),n=r[e];return!!n&&!!this.getEntityIndexMap(n)[t]},mouseDown:function(e){switch(this.dragging=!0,this.gridView){case u.LIGHT:switch(this.control){case d.LIGHT:this.isBlockType(d.LIGHT,e)?this.dragBehavior=g.REMOVE_LIGHT:this.dragBehavior=g.ADD_LIGHT;break;case d.WALL:this.isBlockType(d.WALL,e)?this.dragBehavior=g.REMOVE_WALL:this.dragBehavior=g.ADD_WALL;break}break;case u.ELEVATION:this.dragBehavior=g.INCREASE_ELEVATION;break}this.dragBehavior!==g.INCREASE_ELEVATION&&this.dragHistory.push(e),this.clicked(e)},mouseUp:function(){this.dragging=!1,this.dragHistory=[],this.dragBehavior=g.NONE},mouseEnter:function(e){if(this.dragBehavior===g.INCREASE_ELEVATION)this.clicked(e);else if(!~this.dragHistory.indexOf(e))switch(this.dragHistory.push(e),this.dragBehavior){case g.ADD_LIGHT:this.isBlockType(d.LIGHT,e)||this.clicked(e);break;case g.REMOVE_LIGHT:this.isBlockType(d.LIGHT,e)&&this.clicked(e);break;case g.ADD_WALL:this.isBlockType(d.WALL,e)||this.clicked(e);break;case g.REMOVE_WALL:this.isBlockType(d.WALL,e)&&this.clicked(e);break}},mouseLeft:function(){this.dragging&&this.mouseUp()}}},v=p,f=(i("c783"),i("2877")),L=Object(f["a"])(v,o,s,!1,null,"55fa4cc0",null),m=L.exports,b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.control,expression:"control"}],attrs:{type:"radio",id:"light-control"},domProps:{value:e.blockTypeEnum.LIGHT,checked:e._q(e.control,e.blockTypeEnum.LIGHT)},on:{change:function(t){e.control=e.blockTypeEnum.LIGHT}}}),i("label",{attrs:{for:"light-control"}},[e._v("Light")]),i("br"),i("input",{directives:[{name:"model",rawName:"v-model",value:e.control,expression:"control"}],attrs:{type:"radio",id:"wall-control"},domProps:{value:e.blockTypeEnum.WALL,checked:e._q(e.control,e.blockTypeEnum.WALL)},on:{change:function(t){e.control=e.blockTypeEnum.WALL}}}),i("label",{attrs:{for:"wall-control"}},[e._v("Wall")]),i("br"),i("button",{on:{click:function(t){return e.$emit("reset")}}},[e._v("Reset")]),i("br"),i("input",{directives:[{name:"model",rawName:"v-model",value:e.gridView,expression:"gridView"}],attrs:{type:"radio",id:"light-view-control"},domProps:{value:e.gridViewEnum.LIGHT,checked:e._q(e.gridView,e.gridViewEnum.LIGHT)},on:{change:function(t){e.gridView=e.gridViewEnum.LIGHT}}}),i("label",{attrs:{for:"light-view-control"}},[e._v("Light")]),i("br"),i("input",{directives:[{name:"model",rawName:"v-model",value:e.gridView,expression:"gridView"}],attrs:{type:"radio",id:"elevation-view-control"},domProps:{value:e.gridViewEnum.ELEVATION,checked:e._q(e.gridView,e.gridViewEnum.ELEVATION)},on:{change:function(t){e.gridView=e.gridViewEnum.ELEVATION}}}),i("label",{attrs:{for:"elevation-view-control"}},[e._v("Elevation")])])},w=[],y={name:"LightGridControlSelector",emits:["change-control","change-view","reset"],data:function(){return{control:d.LIGHT,gridView:u.LIGHT,blockTypeEnum:d,gridViewEnum:u}},watch:{control:function(e){this.$emit("change-control",e)},gridView:function(e){this.$emit("change-view",e)}}},E=y,T=Object(f["a"])(E,b,w,!1,null,"fea02e7c",null),O=T.exports,A={name:"App",components:{LightGrid:m,LightGridControlSelector:O},data:function(){return{lights:[],walls:[],elevations:{},gridWidth:40,gridHeight:40,controlType:d.LIGHT,gridView:u.LIGHT}},methods:{addLight:function(e){this.lights.push({x:e.x,y:e.y,strength:14})},removeLight:function(e){this.lights=this.lights.filter((function(t){return!(t.x===e.x&&t.y===e.y)}))},addWall:function(e){this.walls.push({x:e.x,y:e.y})},removeWall:function(e){this.walls=this.walls.filter((function(t){return!(t.x===e.x&&t.y===e.y)}))},increaseElevation:function(e){var t="".concat(e.x,",").concat(e.y);this.elevations[t]?this.elevations[t]++:this.$set(this.elevations,t,1)},reset:function(){this.lights=[],this.walls=[],this.elevations={}},changeControl:function(e){this.controlType=e},changeView:function(e){this.gridView=e}}},I=A,V=(i("034f"),Object(f["a"])(I,n,a,!1,null,null,null)),k=V.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(k)}}).$mount("#app")},"85ec":function(e,t,i){},c783:function(e,t,i){"use strict";var r=i("3f2f"),n=i.n(r);n.a}});
//# sourceMappingURL=app.b35e0728.js.map